{"ast":null,"code":"import React,{useEffect,useState}from'react';import api from'../api';import{LineChart,Line,XAxis,YAxis,Tooltip,ResponsiveContainer}from'recharts';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function PriceChart(){const[data,setData]=useState([]);const[crop,setCrop]=useState('wheat');const fetchHistory=async()=>{try{const resp=await api.get('/api/prices/history');setData((resp.data||[]).map(item=>({x:new Date(item.createdAt).toLocaleString(),y:item.predicted_price})));}catch(e){console.error(e);}};useEffect(()=>{fetchHistory();},[]);const predictNow=async()=>{const resp=await api.post('/api/prices/predict',{crop});await fetchHistory();alert('Predicted: '+resp.data.predicted_price);};return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"card mb-4\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"font-semibold\",children:\"Price Prediction\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-2 mt-2\",children:[/*#__PURE__*/_jsx(\"input\",{value:crop,onChange:e=>setCrop(e.target.value),className:\"border p-2\"}),/*#__PURE__*/_jsx(\"button\",{className:\"px-3 py-2 bg-blue-600 text-white rounded\",onClick:predictNow,children:\"Predict\"}),/*#__PURE__*/_jsx(\"button\",{className:\"px-3 py-2 bg-gray-200 rounded\",onClick:fetchHistory,children:\"Refresh\"})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"card\",style:{height:320},children:/*#__PURE__*/_jsx(ResponsiveContainer,{width:\"100%\",height:\"100%\",children:/*#__PURE__*/_jsxs(LineChart,{data:data.map(d=>({name:d.x,value:d.y})),children:[/*#__PURE__*/_jsx(XAxis,{dataKey:\"name\",tickFormatter:t=>t.split(',')[0]}),/*#__PURE__*/_jsx(YAxis,{}),/*#__PURE__*/_jsx(Tooltip,{}),/*#__PURE__*/_jsx(Line,{type:\"monotone\",dataKey:\"value\",stroke:\"#8884d8\"})]})})})]});}","map":{"version":3,"names":["React","useEffect","useState","api","LineChart","Line","XAxis","YAxis","Tooltip","ResponsiveContainer","jsx","_jsx","jsxs","_jsxs","PriceChart","data","setData","crop","setCrop","fetchHistory","resp","get","map","item","x","Date","createdAt","toLocaleString","y","predicted_price","e","console","error","predictNow","post","alert","children","className","value","onChange","target","onClick","style","height","width","d","name","dataKey","tickFormatter","t","split","type","stroke"],"sources":["C:/Infosys-milestone3/frontend/src/components/PriceChart.jsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport api from '../api';\r\nimport { LineChart, Line, XAxis, YAxis, Tooltip, ResponsiveContainer } from 'recharts';\r\n\r\nexport default function PriceChart(){\r\n  const [data,setData]=useState([]);\r\n  const [crop,setCrop]=useState('wheat');\r\n  const fetchHistory = async ()=>{\r\n    try{\r\n  const resp = await api.get('/api/prices/history');\r\n      setData((resp.data||[]).map(item=>({ x: new Date(item.createdAt).toLocaleString(), y: item.predicted_price })));\r\n    }catch(e){ console.error(e); }\r\n  }\r\n  useEffect(()=>{ fetchHistory() },[]);\r\n\r\n  const predictNow = async ()=>{\r\n  const resp = await api.post('/api/prices/predict',{ crop });\r\n    await fetchHistory();\r\n    alert('Predicted: '+resp.data.predicted_price);\r\n  }\r\n\r\n  return (\r\n    <div>\r\n      <div className=\"card mb-4\">\r\n        <h3 className=\"font-semibold\">Price Prediction</h3>\r\n        <div className=\"flex gap-2 mt-2\">\r\n          <input value={crop} onChange={e=>setCrop(e.target.value)} className=\"border p-2\" />\r\n          <button className=\"px-3 py-2 bg-blue-600 text-white rounded\" onClick={predictNow}>Predict</button>\r\n          <button className=\"px-3 py-2 bg-gray-200 rounded\" onClick={fetchHistory}>Refresh</button>\r\n        </div>\r\n      </div>\r\n      <div className=\"card\" style={{ height: 320 }}>\r\n        <ResponsiveContainer width=\"100%\" height=\"100%\">\r\n          <LineChart data={data.map(d=>({ name: d.x, value: d.y }))}>\r\n            <XAxis dataKey=\"name\" tickFormatter={(t)=>t.split(',')[0]} />\r\n            <YAxis />\r\n            <Tooltip />\r\n            <Line type=\"monotone\" dataKey=\"value\" stroke=\"#8884d8\" />\r\n          </LineChart>\r\n        </ResponsiveContainer>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}